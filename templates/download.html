{% extends "base.html" %}

{% block title %}Download Document - {{ app_name }}{% endblock %}

{% block nav_links %}
<!-- Minimal nav for download page -->
{% endblock %}

{% block content %}
<div class="max-w-xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <!-- Header -->
    <div class="text-center mb-8">
        <div class="w-16 h-16 bg-primary-100 rounded-full flex items-center justify-center mx-auto mb-4">
            <svg class="w-8 h-8 text-primary-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
            </svg>
        </div>
        <h1 class="text-2xl font-bold text-gray-900 mb-2">Legal Document for You</h1>
        <p class="text-gray-600">A document has been served on you via QuickServe Legal</p>
    </div>

    <!-- Document Info -->
    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6">
        <dl class="space-y-4">
            <div>
                <dt class="text-sm text-gray-500">Document</dt>
                <dd class="font-medium text-gray-900">{{ document.original_filename }}</dd>
            </div>
            <div>
                <dt class="text-sm text-gray-500">From</dt>
                <dd class="font-medium text-gray-900">{{ document.sender_name }}</dd>
                <dd class="text-sm text-gray-600">{{ document.sender_email }}</dd>
            </div>
            {% if document.matter_reference %}
            <div>
                <dt class="text-sm text-gray-500">Matter Reference</dt>
                <dd class="font-medium text-gray-900">{{ document.matter_reference }}</dd>
            </div>
            {% endif %}
            {% if document.description %}
            <div>
                <dt class="text-sm text-gray-500">Notes</dt>
                <dd class="text-gray-700">{{ document.description }}</dd>
            </div>
            {% endif %}
            <div>
                <dt class="text-sm text-gray-500">Served On</dt>
                <dd class="font-medium text-gray-900">{{ document.created_at.strftime('%d %B %Y at %H:%M') }}</dd>
            </div>
        </dl>
    </div>

    {% if already_downloaded %}
    <!-- Already Downloaded Notice -->
    <div class="bg-green-50 border border-green-200 rounded-xl p-4 mb-6">
        <div class="flex items-center">
            <svg class="w-5 h-5 text-green-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
            </svg>
            <span class="text-green-800">
                This document was previously downloaded on {{ document.downloaded_at.strftime('%d %b %Y at %H:%M') }}
            </span>
        </div>
    </div>
    {% endif %}

    <!-- Download Button -->
    <form method="POST" action="/download/{{ document.download_token }}" class="text-center">
        <input type="hidden" name="csrf_token" value="{{ request.cookies.get('csrf_token', '') }}">
        <button
            type="submit"
            class="w-full bg-primary-600 hover:bg-primary-700 text-white font-semibold py-4 px-6 rounded-lg transition-colors flex items-center justify-center"
        >
            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/>
            </svg>
            Download Document
        </button>
    </form>

    <!-- Legal Notice -->
    <div class="mt-8 text-center text-sm text-gray-500">
        <p class="mb-2">
            By downloading this document, you acknowledge receipt as per
            <strong>Rule 4A of the Uniform Rules of Court</strong>.
        </p>
        <p>
            The sender will be notified that you have downloaded this document.
        </p>
    </div>

    <!-- What is QuickServe -->
    <div class="mt-8 pt-8 border-t border-gray-200 text-center">
        <p class="text-sm text-gray-500 mb-2">
            QuickServe Legal is a secure platform for electronic service of legal documents.
        </p>
        <a href="/" class="text-primary-600 hover:text-primary-700 text-sm">
            Learn more about QuickServe Legal
        </a>
    </div>
</div>
{% endblock %}
